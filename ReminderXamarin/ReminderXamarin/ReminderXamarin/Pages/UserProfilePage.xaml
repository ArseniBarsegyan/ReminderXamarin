<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:abstractions="clr-namespace:ImageCircle.Forms.Plugin.Abstractions;assembly=ImageCircle.Forms.Plugin"
             xmlns:viewModels="clr-namespace:ReminderXamarin.ViewModels;assembly=ReminderXamarin"
             x:Class="ReminderXamarin.Pages.UserProfilePage"
             BackgroundColor="White"
             Title="Profile">
    <ContentPage.BindingContext>
        <viewModels:UserProfileViewModel x:Name="ViewModel" />
    </ContentPage.BindingContext>
    
    <ContentPage.Content>
        <StackLayout>
            <!-- Header with user name and photo -->
            <StackLayout Spacing="4">
                <abstractions:CircleImage x:Name="UserProfileImage"
                                          Source="{Binding ImageContent, Converter={StaticResource EmptyByteToImageSourceConverter}}"
                                          Style="{StaticResource UserImageStyle}">
                    <abstractions:CircleImage.GestureRecognizers>
                        <TapGestureRecognizer Tapped="UserProfileImage_OnTapped" NumberOfTapsRequired="1" />
                    </abstractions:CircleImage.GestureRecognizers>
                </abstractions:CircleImage>
                
                <!-- Clicking on this icon will open selection of image for user profile -->
                <Image x:Name="EditUserProfilePhoto" 
                       Source="edit.png" 
                       WidthRequest="15"
                       HeightRequest="15"
                       HorizontalOptions="Center"
                       BackgroundColor="LightBlue">
                    <Image.GestureRecognizers>
                        <TapGestureRecognizer Tapped="EditUserProfilePhoto_OnTapped" NumberOfTapsRequired="1" />
                    </Image.GestureRecognizers>
                </Image>
                <Label FontSize="Medium" HorizontalOptions="Center" Text="{Binding UserName}" />
            </StackLayout>
            
            <Button VerticalOptions="EndAndExpand" 
                    Style="{StaticResource SubmitButtonStyle}"
                    Text="Save" 
                    Command="{Binding UpdateUserCommand}" />
        </StackLayout>
    </ContentPage.Content>
</ContentPage>